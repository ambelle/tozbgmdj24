<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Thocky's and Gillian's TOZ 24F BGM Quiz/Practice</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body{
    font-family: Arial, sans-serif;
    background:#101018;
    color:#f5f5f5;
    text-align:center;
    margin:0;
  }

  /* HEADER */
  .hero{
    padding: 26px 14px 6px;
    max-width: 920px;
    margin: 0 auto;
  }
  .heroCard{
    background: #141420;
    border: 1px solid rgba(255,255,255,0.06);
    box-shadow: 0 0 18px rgba(0,0,0,0.45);
    border-radius: 14px;
    padding: 18px 18px 14px;
  }
  .title{
    margin: 2px 0 6px;
    font-size: 2.05rem;
    font-weight: 900;
    letter-spacing: 0.2px;
    line-height: 1.15;
  }
  .badgeRow{
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    margin-top: 8px;
  }
  .badge{
    display:inline-block;
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 0.85rem;
    font-weight: 800;
    background: rgba(63,140,255,0.14);
    border: 1px solid rgba(63,140,255,0.28);
    color: #cfe2ff;
  }
  .desc{
    margin: 12px auto 0;
    max-width: 780px;
    line-height: 1.55;
    color: #d8d8e6;
    font-size: 0.98rem;
  }

  #controls, #answers, #excludeBox{
    background:#181824;
    margin:18px auto;
    padding:16px;
    max-width:560px;
    border-radius:10px;
    box-shadow:0 0 12px rgba(0,0,0,0.45);
  }

  button{
    background:#3f8cff;
    color:white;
    border:none;
    padding:7px 12px;
    border-radius:6px;
    cursor:pointer;
    font-weight:700;
    margin: 4px 6px;
  }

  input[type="text"]{
    width:240px;
    padding:7px 10px;
    background:#101018;
    border:1px solid #444;
    color:white;
    border-radius:6px;
  }

  .row{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
  }

  .microHint{
    margin-top: 8px;
    font-size: 0.88rem;
    color: #cfcfe6;
    opacity: 0.92;
  }
  .microHint b{
    color:#ffffff;
  }

  .correct{ color:#5bd75b; }
  .wrong{ color:#ff6b6b; }

  #player{ position:absolute; left:-9999px; top:-9999px; }

  #scoreLine{
    margin-top: 10px;
    display:flex;
    justify-content:center;
    gap:12px;
    font-size:1.05rem;
  }

  #resultBox{
    margin-top:12px;
    padding:10px;
    border-radius:8px;
    background:#111120;
    min-height:60px;
  }

  #resultStatus{
    font-weight:800;
    font-size:1.15rem;
  }

  #resultTyped,
  #resultCorrect{
    font-size:0.95rem;
    margin-top:4px;
    color:#cfcfe6;
  }

  #excludeList, #answerList{
    columns:2;
    text-align:left;
    font-size:0.95rem;
    padding-left:18px;
  }

  @media (max-width:600px){
    #excludeList, #answerList{ columns:1; }
    input[type="text"]{ width: 90%; max-width: 280px; }
  }

  .hintBox{
    margin-top: 8px;
    padding: 10px;
    background: rgba(63,140,255,0.08);
    border-radius: 8px;
    font-size: 0.9rem;
  }
</style>
</head>

<body>

<!-- CLEAN HEADER -->
<div class="hero">
  <div class="heroCard">
    <div class="title">Thocky's and Gillian's TOZ 24F BGM Quiz/Practice</div>

    <div class="badgeRow">
      <span class="badge">DreamMS Version</span>
      <span class="badge">Practice Tool</span>
      <span class="badge">TOZ 24F</span>
    </div>

    <p class="desc">
      This quiz is built to help players train their TOZ 24F BGM recognition â€”
      so you can identify maps faster by sound and contribute more confidently during runs.
    </p>
  </div>
</div>

<div id="player"></div>

<div id="controls">
  <div class="row">
    <button id="playBtn">Play!</button>
    <button id="stopBtn">Stop</button>
  </div>

  <div style="height:10px"></div>

  <div class="row">
    <b>BGM:</b>
    <input type="text" id="guessInput" placeholder="Type map name here">
    <button id="submitBtn">Submit</button>
  </div>

  <!-- moved here -->
  <div class="microHint">
    Note: Answers are <b>not case-sensitive</b>.
  </div>

  <div id="resultBox">
    <div id="resultStatus"></div>
    <div id="resultTyped"></div>
    <div id="resultCorrect"></div>
  </div>

  <div id="scoreLine">
    <div>Correct: <span id="correctCount" class="correct">0</span></div>
    <div>Wrong: <span id="wrongCount" class="wrong">0</span></div>
  </div>

  <button id="resetBtn">Reset</button>
</div>

<div id="excludeBox">
  <h3>Exclude BGMs from Practice</h3>
  <p>
    Select BGMs you already mastered.
    <br><b>Any checked BGM will be excluded</b> and will not appear in the quiz.
  </p>

  <button id="excludeAllBtn">Exclude All</button>
  <button id="includeAllBtn">Include All</button>

  <div class="hintBox">
    Tip: Exclude everything first, then untick only the BGMs you want to focus on.
  </div>

  <ul id="excludeList"></ul>
</div>

<div id="answers">
  <h3>Available BGMs</h3>
  <ul id="answerList"></ul>
</div>

<script>
const playlist = [
  "Amoria","Aquarium","Ariant","El Nath","Ellinia","Ereve",
  "Florina Beach","Golden Temple","Henesys","Herb Town",
  "Kerning City","Korean Folk Town","Leafre","Ludibrium",
  "Magatia","Mu Lung","Nautilus","New Leaf City",
  "Omega Sector","Orbis","Perion","Rien","Shanghai","Sleepywood"
].map(name => ({ name }));

let excluded = JSON.parse(localStorage.getItem("excludedBGMs") || "[]");
let current = null;

function getPool(){
  return playlist.filter(p => !excluded.includes(p.name));
}

function playRandom(){
  const pool = getPool();
  if (!pool.length) return alert("All BGMs excluded!");
  current = pool[Math.floor(Math.random() * pool.length)];
}

function submitAnswer(){
  if (!current) return alert("Press Play first!");

  const input = document.getElementById("guessInput");
  const guessRaw = input.value.trim();
  if (!guessRaw) return alert("Please type your answer.");

  const guess = guessRaw.toLowerCase();
  const correct = current.name.toLowerCase();

  document.getElementById("resultTyped").textContent =
    "You submitted: " + guessRaw;
  document.getElementById("resultCorrect").textContent =
    "Correct answer: " + current.name;

  if (guess === correct){
    document.getElementById("resultStatus").textContent = "Correct";
    document.getElementById("resultStatus").className = "correct";
    correctCount.textContent++;
  } else {
    document.getElementById("resultStatus").textContent = "Wrong";
    document.getElementById("resultStatus").className = "wrong";
    wrongCount.textContent++;
  }

  input.value = "";
  playRandom();
}

window.onload = () => {
  playlist.forEach(p => {
    const li = document.createElement("li");
    li.textContent = p.name;
    answerList.appendChild(li);

    const ex = document.createElement("li");
    ex.innerHTML = `<label>
      <input type="checkbox" ${excluded.includes(p.name) ? "checked" : ""}>
      ${p.name}
    </label>`;
    ex.querySelector("input").onchange = e => {
      excluded = e.target.checked
        ? [...excluded, p.name]
        : excluded.filter(x => x !== p.name);
      localStorage.setItem("excludedBGMs", JSON.stringify(excluded));
    };
    excludeList.appendChild(ex);
  });

  playBtn.onclick = playRandom;
  stopBtn.onclick = () => current = null;
  submitBtn.onclick = submitAnswer;

  guessInput.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      e.preventDefault();
      submitAnswer();
    }
  });

  resetBtn.onclick = () => {
    correctCount.textContent = 0;
    wrongCount.textContent = 0;
    resultStatus.textContent = "";
    resultTyped.textContent = "";
    resultCorrect.textContent = "";
  };

  excludeAllBtn.onclick = () => {
    excluded = playlist.map(p => p.name);
    localStorage.setItem("excludedBGMs", JSON.stringify(excluded));
    location.reload();
  };

  includeAllBtn.onclick = () => {
    excluded = [];
    localStorage.setItem("excludedBGMs", JSON.stringify(excluded));
    location.reload();
  };
};
</script>

</body>
</html>
