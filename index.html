<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Thocky's TOZ BGM DJ Quiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #101018;
  color: #f5f5f5;
  text-align: center;
  margin: 0;
}

#navbar {
  background: #1a1a25;
  padding: 14px 0;
  border-bottom: 1px solid #333;
}
#navbar a {
  color: #00aaff;
  font-weight: bold;
  text-decoration: none;
  margin: 0 18px;
}

h1 { margin-top: 18px; }

#controls, #answers, #excludeBox {
  background: #181824;
  margin: 18px auto;
  padding: 16px;
  max-width: 520px;
  border-radius: 8px;
}

button {
  background: #3f8cff;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 4px;
  cursor: pointer;
}

input[type="text"] {
  width: 220px;
  padding: 6px;
  background: #101018;
  border: 1px solid #444;
  color: white;
}

.correct { color: #5bd75b; }
.wrong { color: #ff6b6b; }

#player {
  position: absolute;
  left: -9999px;
}

#answerList,
#excludeList {
  columns: 2;
  text-align: left;
  font-size: 0.95rem;
}

@media (max-width: 600px) {
  #answerList,
  #excludeList { columns: 1; }
}
</style>
</head>

<body>

<div id="navbar">
  <a href="index.html">üéß Quiz</a>
  <a href="scanner.html">üîç Scanner</a>
</div>

<h1>Thocky's TOZ BGM DJ Quiz</h1>
<p>DreamMS Version</p>

<div id="player"></div>

<div id="controls">
  <button id="playBtn">Play!</button>
  <button id="stopBtn">Stop</button><br><br>

  BGM:
  <input type="text" id="guessInput" placeholder="Type map name here">
  <button id="submitBtn">Submit</button>

  <div id="resultMessage"></div>

  <div class="score">
    Correct: <span id="correctCount" class="correct">0</span>
    |
    Wrong: <span id="wrongCount" class="wrong">0</span>
  </div>

  <button id="resetBtn">Reset</button>
</div>

<div id="excludeBox">
  <h3>Exclude BGMs from Quiz</h3>
  <p style="font-size:0.9rem;">Select BGMs you already mastered</p>
  <ul id="excludeList"></ul>
</div>

<div id="answers">
  <h3>Available BGMs</h3>
  <ul id="answerList"></ul>
</div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
const playlist = [
  { name: "Amoria", id: "hCdooZxzISo" },
  { name: "Aquarium", id: "qtw0sIBLjrw" },
  { name: "Ariant", id: "w1RgDSoOajw" },
  { name: "El Nath", id: "X6X7U5V9Obk" },
  { name: "Ellinia", id: "gfgBDs8z6WE" },
  { name: "Ereve", id: "3r9s43TG9yA" },
  { name: "Florina Beach", id: "9VqPnUL9Qvs" },
  { name: "Golden Temple", id: "Y_cihkgxF9A" },
  { name: "Henesys", id: "s2_MAplvHeQ" },
  { name: "Herb Town", id: "59oze7IkQ10" },
  { name: "Kerning City", id: "uv8QObpL2EY" },
  { name: "Korean Folk Town", id: "KK_IjvtszTA" },
  { name: "Leafre", id: "theIdIhZzVE" },
  { name: "Ludibrium", id: "49AZqVhXVeU" },
  { name: "Magatia", id: "5FDFLwPw0bU" },
  { name: "Mu Lung", id: "2VMCpGe9MGc" },
  { name: "Nautilus", id: "iZaVKkfuD6s" },
  { name: "New Leaf City", id: "EXv5madDarI" },
  { name: "Omega Sector", id: "LxQt8EVhBOs" },
  { name: "Orbis", id: "DThWMbPZXy8" },
  { name: "Perion", id: "9lwOsX763N0" },
  { name: "Rien", id: "YDfIfL_Fxec" },
  { name: "Shanghai", id: "uZ3egkrlMZY" },
  { name: "Sleepywood", id: "tWCWIhA3XQw" }
];

let excluded = JSON.parse(localStorage.getItem("excludedBGMs") || "[]");
let player, current = null;

function getQuizPlaylist() {
  return playlist.filter(t => !excluded.includes(t.name));
}

function onYouTubeIframeAPIReady() {
  player = new YT.Player("player", {
    videoId: playlist[0].id,
    events: { onReady: () => {} }
  });
}

function playRandom() {
  const quiz = getQuizPlaylist();
  if (!quiz.length) {
    alert("All BGMs are excluded!");
    return;
  }
  current = Math.floor(Math.random() * quiz.length);
  player.loadVideoById(quiz[current].id);
}

function stop() {
  if (player) player.stopVideo();
  current = null;
}

function submitAnswer() {
  const quiz = getQuizPlaylist();
  if (current === null) return alert("Press Play first");
  const guess = guessInput.value.trim().toLowerCase();
  const correct = quiz[current].name.toLowerCase();
  document.getElementById("resultMessage").textContent =
    guess === correct ? "Correct!" : "Wrong! It was " + quiz[current].name;
  guess === correct ? correctCount.textContent++ : wrongCount.textContent++;
  guessInput.value = "";
  playRandom();
}

window.onload = () => {
  playlist.forEach(t => {
    answerList.innerHTML += `<li>${t.name}</li>`;
    excludeList.innerHTML +=
      `<li><label><input type="checkbox" ${excluded.includes(t.name)?"checked":""}
      onchange="toggleExclude('${t.name}')"> ${t.name}</label></li>`;
  });
};

function toggleExclude(name) {
  excluded = excluded.includes(name)
    ? excluded.filter(n => n !== name)
    : [...excluded, name];
  localStorage.setItem("excludedBGMs", JSON.stringify(excluded));
}

playBtn.onclick = playRandom;
stopBtn.onclick = stop;
submitBtn.onclick = submitAnswer;
resetBtn.onclick = () => {
  correctCount.textContent = 0;
  wrongCount.textContent = 0;
};
</script>

</body>
</html>
